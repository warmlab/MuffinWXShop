<form bindsubmit="checkoutOrder" report-submit="true" class="cart-view">
  <view wx:if="{{cur_addr}}" class="address-area">
		<view class="address-info">
			<view class="address-contact">
				<text wx:if="{{cur_addr.is_default}}" class="default">默认</text>
				<text class="name">{{cur_addr.contact}}</text>
				<text class="phone">{{cur_addr.phone}}</text>
			</view>
			<view class="address-address">
				{{cur_addr.province}}{{cur_addr.city}}{{cur_addr.district}}{{cur_addr.address}}
			</view>
		</view>
    <view bindtap="getAddressTap" class="address-choose">
			<text class="fa fa-chevron-right"/>
    </view>
  </view>
  <view wx:else class="adds-center-bg" bindtap="getAddressTap">
		<text class="fa fa-plus" style="font-weight: lighter;"/>
		<view>选择/新增收货地址</view>
  </view>
  <view wx:if="{{cur_addr}}" class="delivery-area">
      <view class="delivery-header" bindtap="deliveryMethodTap">
        <view>配送：{{delivery_method==2 ? '快递配送' : '上门自提'}}</view>
        <text class="fa fa-chevron-down" style="transform:rotate({{delivery_show?180:0}}deg);"/>
      </view>
      <view class="delivery-content" style="display: {{delivery_show?'flex':'none'}}">
        <radio-group bindchange="handleDeliveryChange">
          <view class="delivery-item">
            <text>上门自提</text>
            <radio value="1" checked="{{delivery_method==1}}"/>
          </view>
          <view class="delivery-item">
            <text>快递配送</text>
            <radio value="2" checked="{{delivery_method==2}}"/> 
          </view>
        </radio-group>
      </view>
  </view>
  <view class="pickup-area" wx:if="{{cur_addr && delivery_method == 1}}">
    <view class="pickup-header" bindtap="pickupAddressTap">
      <view class="pickup-title">自提点：{{pickup_index==-1?'请选择自提点':pickup_addresses[pickup_index].name}}</view>
      <view class="pickup-nums">{{pickup_addresses.length}}个自提点
        <text class="fa fa-chevron-down" style="transform:rotate({{pickup_show?180:0}}deg);"/>
      </view>
    </view>
    <view class="pickup-body" style="display: {{pickup_show?'flex':'none'}}">
      <radio-group bindchange="pickupAddressChange">
        <view class="pickup-content" wx:for="{{pickup_addresses}}" wx:key="id">
          <view class="pickup-name">
            <view class="pickup-desc">
              {{item.name}}
              <text wx:if="{{distances.length>0}}">距离{{distances[index]/1000}}公里</text>
            </view>
            <view class="pickup-address">{{item.address}}</view>
          </view>
          <radio value="{{index}}" checked="{{index==pickup_index}}"/> 
        </view>
      </radio-group>
    </view>
	</view>
		<view class="list">
				<view class="group-item">
						<checkbox-group class="goods" bindchange="checkItem">
								<view class="item" wx:for="{{products}}" wx:key="">
										<image class="image" src="{{base_image_url}}/{{item.images[0].image.name}}" mode="aspectFill" data-index="{{index}}" />
										<view class="summary-area">
												<view class="name-area">
														<view class="name">
																{{item.name}}
																<text wx:if="{{!!item.want_size}}">-{{item.want_size.size.name}}</text>
														</view>
														<view class="summary">{{item.summary}}</view>
														<block wx:if="{{item.promotion_id>0}}">
														<view class="price green-color" wx:if="{{!item.want_size}}">￥{{item.promote_price/100}}</view>
														<view class="price green-color" wx:else>
																<text wx:if="{{!item.want_size}}">￥{{item.promote_price/100}}</text>
																<text wx:else>￥{{(item.price+item.want_size.price_plus)/100}}</text>
														</view>
														</block>
														<block wx:else>
														<view class="price green-color" wx:if="{{!item.want_size}}">￥{{item.price/100}}</view>
														<view class="price green-color" wx:else>
																<text wx:if="{{!item.want_size}}">￥{{item.price/100}}</text>
																<text wx:else>￥{{(item.price+item.want_size.price_plus)/100}}</text>
														</view>
														</block>
												</view>
												<view class="amount-area">
														<view class="amount">数量: {{item.want_amount}}</view>
												</view>
										</view>
								</view>
						</checkbox-group>
				</view>
										备注：基础运费￥{{delivery_fee/100}}元，多退少补，谢谢理解，请保持电话畅通（另：滴滴送货的话，只能送到小区门口)
				<view class="form-line">
						<text class="title">订单备注</text>
						<textarea class="note" name="note" placeholder="需要告诉我们什么 可以填在这里" />
				</view>
		</view>
		<view class="cart-bottom">
				<view class="cost">
						<text wx:if="{{delivery_way===1}}">总价: ￥{{cost/100}}</text>
						<text wx:else>总价: ￥{{(cost+delivery_fee)/100}}</text>
				</view>
				<button class="checkout" formType="submit" type="primary" wx:if="{{userInfo.nickname}}">
						提交订单
				</button>
				<button class="checkout" open-type="getUserInfo" bindgetuserinfo="toGetUserInfo" type="warn" wx:else>
						点击登录
				</button>
		</view>
</form>
